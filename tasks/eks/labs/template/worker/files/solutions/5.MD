
create default deny all ingress traffic policy for prod-db namespace
[example](https://kubernetes.io/docs/concepts/services-networking/network-policies/#default-deny-all-ingress-traffic)
````
# vim 5_deny.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny-ingress
  namespace: prod-db     # add it
spec:
  podSelector: {}
  policyTypes:
  - Ingress

````
``` 
k apply -f 5_deny.yaml
```
get namespace labels

```
k get ns --show-labels
```
```
NAME              STATUS   AGE   LABELS
default           Active   12m   kubernetes.io/metadata.name=default
ingress-nginx     Active   12m   kubernetes.io/metadata.name=ingress-nginx,name=ingress-nginx
kube-node-lease   Active   12m   kubernetes.io/metadata.name=kube-node-lease
kube-public       Active   12m   kubernetes.io/metadata.name=kube-public
kube-system       Active   12m   kubernetes.io/metadata.name=kube-system
prod              Active   11m   kubernetes.io/metadata.name=prod
prod-db           Active   11m   kubernetes.io/metadata.name=prod-db
stage             Active   11m   kubernetes.io/metadata.name=stage
team-19           Active   11m   kubernetes.io/metadata.name=team-19


```
```
# vim 5_allow.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow
  namespace: prod-db
spec:
  podSelector: {}

  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: prod
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: stage
      podSelector:
        matchLabels:
          role: db-connect
    - namespaceSelector: {}
      podSelector:
        matchLabels:
          role: db-external-connect



```

test connection from prod namespace  to prod-db namespace
```
kubectl exec prod-app -n prod  -- sh -c ' curl db.prod-db.svc:3306'
```

test  connect from stage NS  and  label: role=db-connect  to prod-db
``` 
kubectl exec stage-app -n stage  -- sh -c ' curl db.prod-db.svc:3306  ' 
```
test connect from any Namespaces and have label: role=db-external-connect  to prod-db

```
kubectl exec all-app -n default  -- sh -c ' curl db.prod-db.svc:3306 ' 

```
test  connect from stage NameSpace all pod   to prod-db
```
kubectl exec not-db-app -n stage -- sh -c ' curl db.prod-db.svc:3306 '

```

test  connect all   pod   to prod-db
``` 
kubectl exec all-not-db-app -n default  -- sh -c ' curl db.prod-db.svc:3306 --connect-timeout 1 -s '
```

test connect from all    pod   to google.com
```
kubectl exec all-not-db-app -n default     -- sh -c ' curl https://google.com  '

```


