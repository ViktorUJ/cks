# Task 01: Install Istio

### Step 1: Switch to Correct Context

```bash
kubectl config use-context cluster1-admin@cluster1
```

### Step 2: Create IstioOperator Configuration

Create the configuration file:

```bash
cat <<EOF > /tmp/istio-config.yaml
apiVersion: install.istio.io/v1alpha1
kind: IstioOperator
spec:
  profile: demo
  components:
    egressGateways:
    - name: istio-demo-egress
      enabled: true
    ingressGateways:
    - name: istio-demo-ingress
      enabled: true
    pilot:
      k8s:
        resources:
          requests:
            cpu: 100m
            memory: 256Mi
          limits:
            cpu: 100m
            memory: 256Mi
        replicaCount: 1
EOF
```

Apply the configuration:

```bash
istioctl install -f /tmp/istio-config.yaml -y
```
### Step 3: Verify Installation

```bash
# Check namespace
kubectl get namespace istio-system 

# Check deployments
kubectl get deployments -n istio-system 

# Verify istiod resources
kubectl get deployment istiod -n istio-system  -o yaml | grep -A 5 resources

# Check pods are running
kubectl get pods -n istio-system 
```

### Step 4: Validate Specific Requirements

```bash
# Verify replica count
kubectl get deployment istiod -n istio-system  -o jsonpath='{.spec.replicas}'

# Verify CPU request
kubectl get deployment istiod -n istio-system  -o jsonpath='{.spec.template.spec.containers[0].resources.requests.cpu}'

# Verify memory request
kubectl get deployment istiod -n istio-system  -o jsonpath='{.spec.template.spec.containers[0].resources.requests.memory}'

# Verify gateways exist
kubectl get deployment istio-demo-ingress -n istio-system 
kubectl get deployment istio-demo-egress -n istio-system 
```
