# Task 05: Fault Injection - Fixed Delay

### Step 1: Switch to Correct Context

```bash
kubectl config use-context cluster3-admin@cluster3
```

### Step 2: Create VirtualService with Fault Delay

Include both short name and FQDN to match requests from within and outside the namespace:

```bash
kubectl apply -f - <<'EOF'
apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: pink-vs
  namespace: pink
spec:
  hosts:
    - pink-echo
  http:
    - fault:
        delay:
          percentage:
            value: 100.0
          fixedDelay: 3s
      route:
        - destination:
            host: pink-echo
            port:
              number: 80
EOF
```

### Step 3: Verify Configuration

```bash
# Check VirtualService exists
kubectl get virtualservice -n pink -o yaml

```

## Testing

### Test Delay Injection

Use `time` to verify the 3-second delay is being applied:

```bash
# Test from black namespace - should take ~3 seconds
time kubectl exec -n pink sleep-pink -- curl -s http://pink-echo.pink.svc.cluster.local/mars

# Expected: Response should take approximately 3 seconds
# Output should show: real 0m3.XXXs
```

The request should complete successfully but take 3 seconds longer than normal.
