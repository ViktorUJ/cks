https://docs.cilium.io/en/stable/security/network/encryption-wireguard/

``` 

# k get no


NAME             STATUS     ROLES           AGE    VERSION
ip-10-10-1-228   NotReady   <none>          97s    v1.31.0
ip-10-10-1-82    NotReady   control-plane   111s   v1.31.0

```
ssh to control-plane
``` 
# ssh to ip-10-10-1-82
``` 

```
# check the kernel version

uname -ar


```

install cilium cli
``` 
cilium_url="https://github.com/cilium/cilium-cli/releases/download/v0.16.17/cilium-linux-arm64.tar.gz"
curl -Lo cilium.tar.gz $cilium_url
tar -zxvf cilium.tar.gz
sudo mv cilium /usr/local/bin/cilium
```

``` 
cilium install --version 1.16.3    --set encryption.enabled=true    --set encryption.type=wireguard

# after installation wait node ready status

```
check node status  , and wait **Ready** status
```
k get no 
```


check all cilium config
```
kubectl -n kube-system exec -ti ds/cilium -- sh -c 'cilium-dbg status'
```


check the encryption status
``` 
kubectl -n kube-system exec -ti ds/cilium -- sh -c 'cilium-dbg status | grep Encryption'
```
``` 
Encryption:                             Wireguard       [NodeEncryption: Disabled, cilium_wg0 (Pubkey: W0xqF1Gj7BNHuT2KCjsuVy08tAANMgHBu3qLtMPBI0Q=, Port: 51871, Peers: 1)]
root@ip-10-10-1-9:/home/ubuntu#


```




check pods communication
```
k exec external -n external  --  sh -c 'curl finance.finance:8080'
``` 